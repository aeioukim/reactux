{"version":3,"sources":["../backend/server.js"],"names":["require","polyfill","app","router","Router","caseSensitive","get","strict","use","__dirname","port","isProduction","process","env","PORT","NODE_ENV","compiler","webpackMiddleware","publicPath","output","quite","contentBase","stats","colors","hash","timings","chunks","chunkModules","modules","response","req","res","write","fileSystem","readFileSync","join","end","static","sendFile","server","listen","host","address","envString","console","log"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACAA,QAAQ,aAAR,EAAuBC,QAAvB;AANA;;AAOAD,QAAQ,kBAAR;;AAEA,IAAME,MAAM,wBAAZ;;AAEA,IAAMC,SAAS,kBAAQC,MAAR,CAAe;AAC7BC,gBAAeH,IAAII,GAAJ,CAAQ,wBAAR,CADc;AAE7BC,SAAQL,IAAII,GAAJ,CAAQ,gBAAR;AAFqB,CAAf,CAAf;;AAKAJ,IAAIM,GAAJ,CAAQ,4BAAQC,YAAY,cAApB,CAAR;AACAP,IAAIM,GAAJ,CAAQL,MAAR;;AAEA,IAAMO,OAAOC,eAAeC,QAAQC,GAAR,CAAYC,IAA3B,GAAkC,IAA/C;AACA,IAAMH,eAAeC,QAAQC,GAAR,CAAYE,QAAZ,KAAyB,YAA9C;;AAGA,IAAI,CAACJ,YAAL,EAAmB;AAAA;AAClB,MAAIK,WAAW,yCAAf;AACA,MAAIC,oBAAoB,oCAAqBD,QAArB,EAA+B;AACtDE,eAAY,kBAAOC,MAAP,CAAcD,UAD4B;AAEtDE,UAAO,IAF+C;AAGtDC,gBAAa,KAHyC;AAItDC,UAAO;AACNC,YAAQ,IADF;AAENC,UAAM,KAFA;AAGNC,aAAS,IAHH;AAINC,YAAQ,KAJF;AAKNC,kBAAc,KALR;AAMNC,aAAS;AANH;AAJ+C,GAA/B,CAAxB;;AAcA1B,MAAIM,GAAJ,CAAQS,iBAAR;AACAf,MAAIM,GAAJ,CAAQ,oCAAqBQ,QAArB,CAAR;AACAb,SAAOG,GAAP,CAAW,GAAX,EAAgB,SAASuB,QAAT,CAAkBC,GAAlB,EAAuBC,GAAvB,EAA4B;AAC3CA,OAAIC,KAAJ,CAAUf,kBAAkBgB,UAAlB,CAA6BC,YAA7B,CAA0C,eAAKC,IAAL,CAAU1B,SAAV,EAAqB,0BAArB,CAA1C,CAAV;AACAsB,OAAIK,GAAJ;AACA,GAHD;AAlBkB;AAsBlB,CAtBD,MAsBO;AACNlC,KAAIM,GAAJ,CAAQ,kBAAQ6B,MAAR,CAAe5B,YAAY,iBAA3B,CAAR;AACAN,QAAOG,GAAP,CAAW,GAAX,EAAgB,SAASuB,QAAT,CAAkBC,GAAlB,EAAuBC,GAAvB,EAA4B;AAC3CA,MAAIO,QAAJ,CAAa,eAAKH,IAAL,CAAU1B,SAAV,EAAqB,2BAArB,CAAb;AACA,EAFD;AAGA;;AAED;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;AAIA;;AAEA;;AAEA;;;;AAIA;;AAEA;;AAEA;;;;AAIA;;AAEA;;AAGA;;AAEA;;AAEA,IAAM8B,SAASrC,IAAIsC,MAAJ,CAAW9B,IAAX,EAAiB,YAAW;;AAE1C,KAAI+B,OAAOF,OAAOG,OAAP,GAAiBA,OAA5B;AACA,KAAIhC,OAAO6B,OAAOG,OAAP,GAAiBhC,IAA5B;;AAEA,KAAIiC,YAAYhC,eAAe,YAAf,GAA8B,aAA9C;;AAEAiC,SAAQC,GAAR,CAAYF,YAAY,mCAAxB,EAA6DF,IAA7D,EAAmE/B,IAAnE;AAEA,CATc,CAAf;;AAYA;AACA;AACA","file":"server.js","sourcesContent":["import express from 'express';\nimport bodyParser from 'body-parser';\nimport morgan from 'morgan';\nimport favicon from 'serve-favicon';\n// webpack\nimport path from 'path';\nimport webpack from 'webpack';\nimport webpackDevMiddleware from 'webpack-dev-middleware';\nimport webpackHotMiddleware from 'webpack-hot-middleware';\nimport config from './webpack.config';\nrequire('es6-promise').polyfill();\nrequire('isomorphic-fetch');\n\nconst app = express();\n\nconst router = express.Router({\n\tcaseSensitive: app.get('case sensitive routing'),\n\tstrict: app.get('strict routing')\n});\n\napp.use(favicon(__dirname + \"/favicon.ico\"));\napp.use(router);\n\nconst port = isProduction ? process.env.PORT : 3000;\nconst isProduction = process.env.NODE_ENV === 'production';\n\n\nif (!isProduction) {\n\tlet compiler = webpack(config);\n\tlet webpackMiddleware = webpackDevMiddleware(compiler, {\n\t\tpublicPath: config.output.publicPath,\n\t\tquite: true,\n\t\tcontentBase: 'src',\n\t\tstats: {\n\t\t\tcolors: true,\n\t\t\thash: false,\n\t\t\ttimings: true,\n\t\t\tchunks: false,\n\t\t\tchunkModules: false,\n\t\t\tmodules: false\n\t\t}\n\t});\n\n\tapp.use(webpackMiddleware);\n\tapp.use(webpackHotMiddleware(compiler));\n\trouter.get('/', function response(req, res) {\n\t\tres.write(webpackMiddleware.fileSystem.readFileSync(path.join(__dirname, 'frontend/dist/index.html')));\n\t\tres.end();\n\t});\n} else {\n\tapp.use(express.static(__dirname + '/frontend/build'));\n\trouter.get('/', function response(req, res) {\n\t\tres.sendFile(path.join(__dirname, 'frontend/build/index.html'));\n\t});\n}\n\n// var router = express.Router({\n//     caseSensitive: app.get('case sensitive routing'),\n//     strict: app.get('strict routing')\n// });\n\n// Parse application/json\n// app.use(bodyParser.json());\n\n/*===========================================\n=            Baic Authentication            =\n===========================================*/\n\n// app.use(require('node-basicauth')({'haochuan': 'password'}));\n\n/*=====  End of Baic Authentication  ======*/\n\n/*====================================\n=            Basic Logger            =\n====================================*/\n\n// app.use(morgan('tiny'));\n\n/*=====  End of Basic Logger  ======*/\n\n/*===========================\n=            COR            =\n===========================*/\n\n// app.use(require('cors')());\n\n/*=====  End of COR  ======*/\n\n\n// app.use(router);\n\n// app.use(express.static('dist'));\n\nconst server = app.listen(port, function() {\n\n\tlet host = server.address().address;\n\tlet port = server.address().port;\n\n\tvar envString = isProduction ? \"Production\" : \"Development\";\n\n\tconsole.log(envString + ' server listening at http://%s:%s', host, port);\n\n});\n\n\n// app.get('/', function (req, res) {\n//   res.sendFile(__dirname + '/src/index.html');\n// });\n"]}